"use strict";
module.exports = function (policy) {
    return policy.split(';').reduce((result, directive) => {
        const trimmed = directive.trim();
        if (!trimmed) {
            return result;
        }
        const split = trimmed.split(/\s+/g);
        const key = split.shift();
        if (!Object.prototype.hasOwnProperty.call(result, key)) {
            result[key] = split;
        }
        return result;
    }, {});
};
